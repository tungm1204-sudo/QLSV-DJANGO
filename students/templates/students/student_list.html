{% extends 'core/base.html' %} {% block title %} Students - QLSV {% endblock %}
{% block header_title %} Students {% endblock %} {% block content %}
<div class="card animate-fade-in">
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
    <form method="get" action="{% url 'students:student_list' %}" style="display: flex; gap: 0.5rem">
      <input type="text" name="q" value="{{ request.GET.q|default:'' }}" placeholder="Search students..." style="padding: 0.6rem 1rem; border: 1px solid var(--border); border-radius: 10px; width: 300px; outline: none;" />
      <button type="submit" class="btn" style="background: var(--light); color: var(--primary)">
        <i class="fa-solid fa-magnifying-glass"></i>
      </button>
      {% if request.GET.q %}
      <a href="{% url 'students:student_list' %}" class="btn" style="background: #fff1f2; color: #e11d48">Clear</a>
      {% endif %}
    </form>
    {% if perms.students.add_student %}
    <a href="{% url 'students:student_create' %}" class="btn btn-primary">
      <i class="fa-solid fa-plus"></i> Add New Student
    </a>
    {% endif %}
  </div>

  <div class="table-container">
    <table>
      <thead>
        <tr>
          <th>Full Name</th>
          <th>Email</th>
          <th>Parent</th>
          <th>Status</th>
          {% if perms.students.change_student or perms.students.delete_student %}
          <th>Actions</th>
          {% endif %}
        </tr>
      </thead>
      <tbody>
        {% for student in students %}
        <tr>
          <td style="font-weight: 500">
            {{ student.fname }} {{ student.lname }}
          </td>
          <td>{{ student.email }}</td>
          <td>{{ student.parent|default:"-" }}</td>
          <td><span class="status-badge status-active">Active</span></td>
          {% if perms.students.change_student or perms.students.delete_student %}
          <td>
            <div style="display: flex; gap: 0.5rem">
              {% if perms.students.change_student %}
              <a href="{% url 'students:student_update' student.pk %}" class="btn" style="background: #f0f4ff; color: var(--primary); padding: 0.4rem 0.8rem;">
                <i class="fa-solid fa-edit"></i>
              </a>
              {% endif %} 
              {% if perms.students.delete_student %}
              <a href="{% url 'students:student_delete' student.pk %}" class="btn" style="background: #fff1f2; color: #e11d48; padding: 0.4rem 0.8rem;">
                <i class="fa-solid fa-trash"></i>
              </a>
              {% endif %}
            </div>
          </td>
          {% endif %}
        </tr>
        {% empty %}
        <tr>
          <td colspan="5" style="text-align: center; padding: 2rem; color: var(--gray)">
            No students found.
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}